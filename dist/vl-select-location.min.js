import{define}from"/node_modules/vl-ui-core/dist/vl-core.min.js";import{VlSelect}from"/node_modules/vl-ui-select/dist/vl-select.min.js";import LambertCoordinaat from"/node_modules/vl-ui-map/src/lambert-coordinaat.js";class VlSelectLocation extends VlSelect{static get _observedAttributes(){return["placeholder"]}constructor(){super(),this.setAttribute("data-vl-select",""),this._addSearchEventListener(),this._addChoiceEventListener(),this._addPlaceholder(),this.placeholder="Lokaliseer adres"}get location(){const e=this._choices?.getValue()?.value;if(e)return e.BoundingBox?Promise.resolve([e.BoundingBox.LowerLeft.X_Lambert72,e.BoundingBox.LowerLeft.Y_Lambert72,e.BoundingBox.UpperRight.X_Lambert72,e.BoundingBox.UpperRight.Y_Lambert72]):LambertCoordinaat.isLambertCoordinaat(e)?Promise.resolve([e.x-1,e.y-1,e.x+1,e.y+1]):fetch(this._locationUrl+encodeURIComponent(e)).then((e=>e.json())).then((e=>[e.LocationResult[0].BoundingBox.LowerLeft.X_Lambert72,e.LocationResult[0].BoundingBox.LowerLeft.Y_Lambert72,e.LocationResult[0].BoundingBox.UpperRight.X_Lambert72,e.LocationResult[0].BoundingBox.UpperRight.Y_Lambert72]))}set placeholder(e){this._placeholderElement.innerText=e}get _url(){return"https://loc.geopunt.be/v4"}get _searchUrl(){return this._url+"/Suggestion?q="}get _locationUrl(){return this._url+"/Location?q="}get _locationXyUrl(){return this._url+"/Location?c=5&xy="}get _placeholderElement(){return this.querySelector("option[placeholder]")}_placeholderChangedCallback(e,t){this.placeholder=t}_addSearchEventListener(){this.addEventListener("search",(e=>{if(e&&e.detail&&e.detail.value){const t=LambertCoordinaat.of(e.detail.value);LambertCoordinaat.isLambertCoordinaat(t)?this._searchChoicesByLambertCoordinaat(t):this._searchChoicesByValue(e.detail.value)}}))}_searchChoicesByValue(e){fetch(this._searchUrl+encodeURIComponent(e)).then((e=>e.json())).then((e=>{this.choices=this._mapSuggestionResultToChoices(e)}))}_mapSuggestionResultToChoices(e){return e&&e.SuggestionResult?e.SuggestionResult.map((e=>({value:e,label:e}))):[]}_searchChoicesByLambertCoordinaat(e){fetch(this._locationXyUrl+e.x+","+e.y).then((e=>e.json())).then((t=>{this.choices=[this._mapLambertCoordinaatToChoice(e)].concat(this._mapLocationResultToChoices(t))}))}_mapLambertCoordinaatToChoice(e){return{value:e,label:"Lambert-coördinaat: "+e.toString()}}_mapLocationResultToChoices(e){return e&&e.LocationResult?e.LocationResult.map((e=>({value:e,label:e.FormattedAddress}))):[]}_addChoiceEventListener(){this.addEventListener("choice",(()=>setTimeout((()=>this.dispatchEvent(new Event("change"))))))}_addPlaceholder(){this.insertAdjacentHTML("afterbegin","<option placeholder></option>")}get DEFAULT_SEARCH_PLACEHOLDER(){return"Zoeken op adres of coördinaat"}get DEFAULT_NO_MORE_OPTIONS(){return"Geen adres gevonden"}get DEFAULT_SEARCH_NO_RESULT(){return"Geen adres gevonden"}}export{LambertCoordinaat,VlSelectLocation};define("vl-select-location",VlSelectLocation,{extends:"select"});