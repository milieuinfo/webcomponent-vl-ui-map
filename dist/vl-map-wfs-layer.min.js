import{define}from"/node_modules/vl-ui-core/dist/vl-core.min.js";import{VlMapVectorLayer}from"/node_modules/vl-ui-map/dist/vl-map-vector-layer.min.js";import{OlVectorSource,OlLoadingstrategy,OlGML2}from"/node_modules/vl-mapactions/dist/vl-mapactions.js";export class VlMapWfsLayer extends VlMapVectorLayer{connectedCallback(){super.connectedCallback(),this._source=this.__createSource(),this._layer=this._createLayer()}get _url(){const e=this.getAttribute("url");if(!e)throw new Error("URL not defined");return new URL(e)}get _layers(){const e=this.getAttribute("layers");if(!e)throw new Error("Layers not defined");return e}__createSource(){const e=new OlVectorSource({format:this.__sourceFormat,strategy:this.__loadingStrategy,url:this.__getWfsUrl.bind(this)});return e.on("featuresloadend",(()=>this.rerender())),e}__getWfsUrl(e,t,r){const s=this._url,o=s.searchParams;return o.set("service","WFS"),o.set("request","GetFeature"),o.set("typename",this._layers),o.set("bbox",e.join(",")),o.set("srsname",r.getCode()),o.set("outputFormat",this.__wfsOutputFormat),o.set("version",this.__wfsVersion),s}get __loadingStrategy(){return OlLoadingstrategy.bbox}get __sourceFormat(){return new OlGML2}get __wfsOutputFormat(){return"GML2"}get __wfsVersion(){return"2.0.0"}}define("vl-map-wfs-layer",VlMapWfsLayer);