import{vlElement}from"/node_modules/vl-ui-core/dist/vl-core.min.js";import"/node_modules/vl-ui-select/dist/vl-select.min.js";export class VlMapSearch extends(vlElement(HTMLElement)){constructor(){super("\n      <style>\n        @import '/node_modules/vl-ui-select/dist/style.css';\n      </style>\n    "),this._configure(),customElements.whenDefined("vl-select").then(()=>{this._shadow.appendChild(this._getSelectTemplate()),this._addSearchEventListener(),this._addChoiceEventListener()})}get url(){return"https://loc.geopunt.be/v4"}get searchUrl(){return this.url+"/Suggestion?q="}get locationUrl(){return this.url+"/Location?q="}get _selectElement(){return this._shadow.querySelector("select")}get _parentElement(){if(this.parentNode)return this.parentNode.host}bindMap(e){this._map=e}_getSelectTemplate(){return this._template('\n      <select is="vl-select" id="test" data-vl-select data-vl-select-deletable data-vl-select-search-empty-text="Geen adres gevonden"></select>\n    ')}_addSearchEventListener(){this.__searchEventListenerRegistered||(this.__searchEventListenerRegistered=!0,this._selectElement.addEventListener("search",e=>{e&&e.detail&&e.detail.value&&fetch(this.searchUrl+e.detail.value).then(e=>e.json()).then(e=>{if(e&&e.SuggestionResult){const t=e.SuggestionResult.map(e=>({value:e,label:e}));this._selectElement.choices=t}})}))}_addChoiceEventListener(){this.__choiceEventListenerRegistered||(this.__choiceEventListenerRegistered=!0,this.__choiceEventListener=this._selectElement.addEventListener("choice",e=>{e&&e.detail&&e.detail.choice&&fetch(this.locationUrl+e.detail.choice.value).then(e=>e.json()).then(e=>{e&&e.LocationResult&&this._map&&this._map.zoomTo([e.LocationResult[0].BoundingBox.LowerLeft.X_Lambert72,e.LocationResult[0].BoundingBox.LowerLeft.Y_Lambert72,e.LocationResult[0].BoundingBox.UpperRight.X_Lambert72,e.LocationResult[0].BoundingBox.UpperRight.Y_Lambert72])})}))}_configure(){customElements.whenDefined("vl-map").then(()=>{this.parentNode&&this.parentNode.map&&(this.parentNode._shadow.prepend(this),this.parentNode.host.style.setProperty("--vl-map--margin-top","35px"),this._map=this._parentElement)})}}
