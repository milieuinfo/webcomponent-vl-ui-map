import{define}from"/node_modules/vl-ui-core/dist/vl-core.min.js";import{VlMapLayer}from"/node_modules/vl-ui-map/dist/vl-map-layer.min.js";import{OlWMTSSource,OlWMTSTileGrid,OlTileLayer,OlExtent}from"/node_modules/vl-mapactions/dist/vl-mapactions.js";export class VlMapWmtsLayer extends VlMapLayer{connectedCallback(){super.connectedCallback(),this._source=this.__createSource(),this._layer=this._createLayer()}get _projection(){if(this.parentNode)return this.parentNode._projection}get url(){const t=this.getAttribute("data-vl-url");if(!t)throw new Error("URL not defined");return t}get _wmtsLayer(){const t=this.getAttribute("data-vl-layer");if(!t)throw new Error("Layer not defined");return t}_createLayer(){const t=new OlTileLayer({title:this._name,source:this._source,minResolution:this._minResolution,maxResolution:this._maxResolution,visible:this._visible});return t.set("id",VlMapLayer._counter),t}__createSource(){const t=this.__grbTileLimits,e=new OlWMTSSource({url:this.url,layer:this._wmtsLayer,matrixSet:this.__grbMatrixSet,format:this.__wmtsFormat,projection:this._projection,tileGrid:new OlWMTSTileGrid({extent:this._projection.getExtent(),origin:OlExtent.getTopLeft(this._projection.getExtent()),resolutions:t.resolutions,matrixIds:t.matrixIds}),style:""});return e.on("tileloadend",this.rerender),e}get __wmtsFormat(){return"image/png"}get __grbMatrixSet(){return"BPL72VL"}get __grbTileLimits(){const t=OlExtent.getWidth(this._projection.getExtent())/256,e=new Array(16),r=new Array(16);for(let i=0;i<16;++i)e[i]=t/Math.pow(2,i),r[i]=i;return{matrixIds:r,resolutions:e}}}define("vl-map-wmts-layer",VlMapWmtsLayer);