<!doctype html>
<html>

<head>
    <meta charset="utf-8">
    <script src="../../../@webcomponents/webcomponentsjs/webcomponents-lite.js"></script>
    <script src="../../../web-component-tester/browser.js"></script>

    <script src="ol-util.js"></script>
    <script type="module" src="../../src/vl-map-all.js"></script>
</head>

<body>
<test-fixture id="vl-map-overview-map-fixture">
    <template>
        <vl-map>
            <vl-map-overview-map></vl-map-overview-map>
            <vl-map-baselayer url="https://localhost" layer="layername_1"  title="layer title 1"></vl-map-baselayer>
        </vl-map>
    </template>
</test-fixture>

<script>
    suite('vl-map-overview-map', () => {
      const sandbox = sinon.sandbox.create();

      setup((done) => {
        customElements.whenDefined('vl-map-overview-map').then(done);
      });

      teardown(() => {
        sandbox.restore();
      });

      function bevatOverviewMap(map) {
        return map.getControls().getArray().includes(map.overviewMapControl);
      }

      test('de overview map wordt goed geconfigureerd', (done) => {
        const element = fixture('vl-map-overview-map-fixture');
        const vlMapOverviewMapElement = element.querySelector('vl-map-overview-map');
        (async () => {
          while (!bevatOverviewMap(vlMapOverviewMapElement._map)) {
            await new Promise((resolve) => setTimeout(resolve, 100));
          }
          done();
        })();
      });
    });
</script>
</body>

</html>
